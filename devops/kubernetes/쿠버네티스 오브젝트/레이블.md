# 레이블

레이블은 파드를 포함한 쿠버네티스 오브젝트에 첨부된 key-value 데이터이다. 레이블은 쿠버네티스의 오브젝트를 선택하는 데 사용되는데, 달리 말하면 쿠버네티스 오브젝트는 레이블을 통해 논리적인 그룹을 형성할 수 있다. 

사용 용도를 간략하게 요약한다면 다음과 같다.

* 스케줄링 (노드, 파드 셀렉터)
* 서비스 디스커버리 (서비스)
* 메타데이터 저장
* istio 트래픽 제어 (Virtual Service)



## 구문

레이블은 key-value 구조로 되어있으며 `metadata.labels` 에서 레이블을 정의할 수 있다. 레이블 이름의 규칙은 다음과 같다.

* 63자이하
* 시작과 끝은 `[a-z0-9A-Z]` (alphanumeric)
* 알파벳, 숫자를 포함하여 `-`, `_`, `.` 을 포함할 수 있다.





## 레이블 셀렉터

레이블 셀렉터라는 것을 통해 레이블을 이용하여 쿠버네티스 오브젝트를 식별할 수 있다. 레이블 셀렉터를 통해 파드를 세트로 쿼리하거나 식별하고 하나의 논리적 단위로 관리할 수 있다. 이를 통해 레이블을 선택하여 특정 리소스만 배포하거나 업데이트할 수 있고, 레이블로 선택된 리소스만 특정 서비스에 연결하거나 특정 레이블로 선택된 리소스에만 네트워크 접근 권한을 부여할 수도 있다. 

레이블 셀렉터는 **일치성 기준** 과 **집합성 기준** 이라는 두 종류의 셀렉터를 지원한다.



### 일치성 기준

일치성 기준은 셀렉터에 명시되어있는 키 값이 **일치**하는지 또는 **불일치**하는지에 대한 논리 연산을 지원한다. 연산자로는 `=`, `==`, `!=` 이라는 세 가지 연산자만 허용한다. 

일치성 기준은 `selector.matchLabels` 에서 정의할 수 있다.

```yaml
spec:
  selector:
    matchLabels:
     app: todo-list
```



### 집합성 기준

집합성 기준은 포함 (비포함) 여부에 대한 집합 연산을 지원한다. 연산자로는 `in`, `notIn`, `exists` 연산자가 있다.

집합성 기준은 `selector.matchExpressions` 에서 정의할 수 있다.

```yaml
spec:
  selector:
    matchExpressions:
    - key: app
      operator: in
      values:
      - todo-list
      - scheduler
```

* key: 레이블의 key
* operator: 연산자, `in`, `notIn`, `exists` 중 하나를 지정하면 된다.
* values: String 배열로 포함/비포함의 기준 value를 지정하면 된다. `exists`이면 생략한다. 

